import{A as f,E as C,a as H,b as g,k as L,r as j,j as e,K as b,R as y,Q as p,p as w,m as q,q as D,s as M,t as T,L as U,S as _,v as G,w as K,G as W,o as B,x as $,W as J,O as Q,H as Z,B as V,F as X,h as Y,i as ee}from"./index-1473f838.js";const se=async t=>(await f.post(C.UPDATE_PROFILE,t.data,{headers:{Authorization:t.token,"Content-Type":"multipart/form-data"}})).data,ae=()=>{const{isLoading:t,mutateAsync:r}=H(b.UPDATE_PROFILE,se),s=g(a=>a.personalDetailsReducer.profileData),h=g(a=>a.personalDetailsReducer.token),u=L(),[n,o]=j.useState({name:s!=null&&s.name?s==null?void 0:s.name:"",address:s!=null&&s.address?s==null?void 0:s.address:"",city:s!=null&&s.city?s==null?void 0:s.city:"",country:s!=null&&s.country?s==null?void 0:s.country:"India",phoneNumber:s!=null&&s.phoneNumber?s==null?void 0:s.phoneNumber:"",state:s!=null&&s.state?s==null?void 0:s.state:"Andhra Pradesh",zipCode:s!=null&&s.zipCode?s==null?void 0:s.zipCode:""}),[l,m]=j.useState(null),c=a=>{var x;const i=((x=a.target.files)==null?void 0:x[0])||null;m(i)},d=(a,i)=>{o(x=>({...x,[a]:i.target.value}))},v=a=>{var x,P,A,k,S,O,R;if(a.preventDefault(),t)return;const i=new FormData;if(s.zipCode!==n.zipCode&&((x=n.zipCode)==null?void 0:x.trim())!==""){if(!y.ZIP.test(n==null?void 0:n.zipCode)){p.error("Please enter valid ZIP Code");return}i.append("zipCode",n.zipCode)}if(s.phoneNumber!==n.phoneNumber&&((P=n.phoneNumber)==null?void 0:P.trim())!==""){if(!y.PHONE.test(n==null?void 0:n.phoneNumber)){p.error("Please enter valid Phone Number");return}i.append("phoneNumber",n.phoneNumber)}s.name!==n.name&&((A=n.name)==null?void 0:A.trim())!==""&&i.append("name",n.name),s.address!==n.address&&((k=n.address)==null?void 0:k.trim())!==""&&i.append("address",n.address),s.city!==n.city&&((S=n.city)==null?void 0:S.trim())!==""&&i.append("city",n.city),s.state!==n.state&&((O=n.state)==null?void 0:O.trim())!==""&&i.append("state",n.state),s.country!==n.country&&((R=n.country)==null?void 0:R.trim())!==""&&i.append("country",n.country),l!=null&&l.size&&i.append("image",l),r({data:i,token:h}).then(N=>{u(w.fillProfileData({data:N.data})),p.success(N.message)}).catch(N=>{var F,E,I,z;return p.error((E=(F=N.response)==null?void 0:F.data)!=null&&E.error?(z=(I=N.response)==null?void 0:I.data)==null?void 0:z.error:"Unable to update profile right now!")})};return e.jsx("div",{className:"tab-pane fade",id:"account-info",role:"tabpanel",children:e.jsx("div",{className:"myaccount-content",children:e.jsx("div",{className:"account-details-form",children:e.jsxs("form",{onSubmit:v,children:[e.jsxs("div",{className:"single-input-item",children:[e.jsxs("label",{htmlFor:"display-pic",className:"required",children:["Display Picture"," ",e.jsx("small",{className:"form-text text-muted",children:"(Recommended Size - 128 x 128)"})]}),e.jsxs("div",{className:"file-input",children:[e.jsx("input",{type:"file",id:"customFileInput",accept:"image/*",onChange:c}),e.jsx("label",{htmlFor:"customFileInput",children:e.jsx("span",{children:l!=null&&l.name?l==null?void 0:l.name:"Choose File"})})]})]}),e.jsxs("div",{className:"single-input-item",children:[e.jsx("label",{htmlFor:"full-name",className:"required",children:"Full Name"}),e.jsx("input",{type:"text",id:"full-name",value:n.name,onChange:d.bind(void 0,"name")})]}),e.jsxs("div",{className:"single-input-item",children:[e.jsx("label",{htmlFor:"address",className:"required",children:"Address"}),e.jsx("input",{type:"text",id:"address",value:n.address,onChange:d.bind(void 0,"address")})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-6",children:e.jsxs("div",{className:"single-input-item",children:[e.jsx("label",{htmlFor:"city",className:"required",children:"City"}),e.jsx("input",{type:"text",id:"city",value:n.city,onChange:d.bind(void 0,"city")})]})}),e.jsx("div",{className:"col-lg-6",children:e.jsxs("div",{className:"single-input-item",children:[e.jsx("label",{htmlFor:"zip",className:"required",children:"ZIP Code"}),e.jsx("input",{type:"text",id:"zip",value:n.zipCode,onChange:d.bind(void 0,"zipCode")})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-6",children:e.jsxs("div",{className:"single-input-item",children:[e.jsx("label",{htmlFor:"state",className:"required",children:"State"}),e.jsxs("select",{className:"select-active",id:"state",value:n.state,onChange:d.bind(void 0,"state"),children:[e.jsx("option",{value:"Andhra Pradesh",children:"Andhra Pradesh"}),e.jsx("option",{value:"Andaman and Nicobar Islands",children:"Andaman and Nicobar Islands"}),e.jsx("option",{value:"Arunachal Pradesh",children:"Arunachal Pradesh"}),e.jsx("option",{value:"Assam",children:"Assam"}),e.jsx("option",{value:"Bihar",children:"Bihar"}),e.jsx("option",{value:"Chandigarh",children:"Chandigarh"}),e.jsx("option",{value:"Chhattisgarh",children:"Chhattisgarh"}),e.jsx("option",{value:"Dadar and Nagar Haveli",children:"Dadar and Nagar Haveli"}),e.jsx("option",{value:"Daman and Diu",children:"Daman and Diu"}),e.jsx("option",{value:"Delhi",children:"Delhi"}),e.jsx("option",{value:"Lakshadweep",children:"Lakshadweep"}),e.jsx("option",{value:"Puducherry",children:"Puducherry"}),e.jsx("option",{value:"Goa",children:"Goa"}),e.jsx("option",{value:"Gujarat",children:"Gujarat"}),e.jsx("option",{value:"Haryana",children:"Haryana"}),e.jsx("option",{value:"Himachal Pradesh",children:"Himachal Pradesh"}),e.jsx("option",{value:"Jammu and Kashmir",children:"Jammu and Kashmir"}),e.jsx("option",{value:"Jharkhand",children:"Jharkhand"}),e.jsx("option",{value:"Karnataka",children:"Karnataka"}),e.jsx("option",{value:"Kerala",children:"Kerala"}),e.jsx("option",{value:"Madhya Pradesh",children:"Madhya Pradesh"}),e.jsx("option",{value:"Maharashtra",children:"Maharashtra"}),e.jsx("option",{value:"Manipur",children:"Manipur"}),e.jsx("option",{value:"Meghalaya",children:"Meghalaya"}),e.jsx("option",{value:"Mizoram",children:"Mizoram"}),e.jsx("option",{value:"Nagaland",children:"Nagaland"}),e.jsx("option",{value:"Odisha",children:"Odisha"}),e.jsx("option",{value:"Punjab",children:"Punjab"}),e.jsx("option",{value:"Rajasthan",children:"Rajasthan"}),e.jsx("option",{value:"Sikkim",children:"Sikkim"}),e.jsx("option",{value:"Tamil Nadu",children:"Tamil Nadu"}),e.jsx("option",{value:"Telangana",children:"Telangana"}),e.jsx("option",{value:"Tripura",children:"Tripura"}),e.jsx("option",{value:"Uttar Pradesh",children:"Uttar Pradesh"}),e.jsx("option",{value:"Uttarakhand",children:"Uttarakhand"}),e.jsx("option",{value:"West Bengal",children:"West Bengal"})]})]})}),e.jsx("div",{className:"col-lg-6",children:e.jsxs("div",{className:"single-input-item",children:[e.jsx("label",{htmlFor:"country",className:"required",children:"Country"}),e.jsx("select",{className:"select-active",id:"country",value:n.country,onChange:d.bind(void 0,"country"),children:e.jsx("option",{value:"India",children:"India"})})]})})]}),e.jsxs("div",{className:"single-input-item",children:[e.jsx("label",{htmlFor:"phone",className:"required",children:"Phone Number"}),e.jsx("input",{type:"text",id:"phone",value:n.phoneNumber,onChange:d.bind(void 0,"phoneNumber")})]}),e.jsx("div",{className:"single-input-item",children:e.jsx("button",{className:"check-btn sqr-btn ",children:t?e.jsx("div",{className:"loading-spinner"}):"Save Changes"})})]})})})})},ne=async t=>(await f.post(C.CHANGE_PASSWORD,t.data,{headers:{Authorization:t.token}})).data,re=()=>{const{isLoading:t,mutateAsync:r}=H(b.CHANGE_PASSWORD,ne),s=g(m=>m.personalDetailsReducer.token),[h,u]=j.useState({oldPassword:"",newPassword:""}),n=j.useRef(null),o=(m,c)=>{u(d=>({...d,[m]:c.target.value}))},l=m=>{var c;if(m.preventDefault(),((c=n.current)==null?void 0:c.value)!==h.newPassword){p.warn("New Password and Confirm Password should match each other");return}if(!y.PASSWORD.test(h.newPassword)){p.warn("Please enter a valid 8 characters new password containing both alphabets and numbers");return}r({data:h,token:s}).then(d=>{u({newPassword:"",oldPassword:""}),n.current.value="",p.success(d.message)}).catch(d=>{var v,a,i,x;return p.error((a=(v=d.response)==null?void 0:v.data)!=null&&a.error?(x=(i=d.response)==null?void 0:i.data)==null?void 0:x.error:"Unable to change password right now!")})};return e.jsx("div",{className:"tab-pane fade",id:"change-pass",role:"tabpanel",children:e.jsx("div",{className:"myaccount-content",children:e.jsxs("form",{className:"account-details-form",onSubmit:l,children:[e.jsxs("fieldset",{children:[e.jsx("legend",{children:"Change Password"}),e.jsxs("div",{className:"single-input-item",children:[e.jsx("label",{htmlFor:"current-pwd",className:"required",children:"Current password"}),e.jsx("input",{type:"password",id:"current-pwd",value:h.oldPassword,onChange:o.bind(void 0,"oldPassword")})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-12",children:e.jsxs("div",{className:"single-input-item",children:[e.jsx("label",{htmlFor:"new-pwd",className:"required",children:"New password"}),e.jsx("input",{type:"password",id:"new-pwd",value:h.newPassword,onChange:o.bind(void 0,"newPassword")})]})}),e.jsx("div",{className:"col-lg-12",children:e.jsxs("div",{className:"single-input-item",children:[e.jsx("label",{htmlFor:"confirm-pwd",className:"required",children:"Confirm new password"}),e.jsx("input",{type:"password",id:"confirm-pwd",ref:n})]})})]})]}),e.jsx("div",{className:"single-input-item",children:e.jsx("button",{className:"check-btn sqr-btn ",children:t?e.jsx("div",{className:"loading-spinner"}):"Change Password"})})]})})})},ie=t=>{const r=g(s=>s.personalDetailsReducer.profileData);return e.jsx("div",{className:`tab-pane fade ${t.isOrderActive?"":"show active"}`,id:"dashboard",role:"tabpanel",children:e.jsxs("div",{className:"myaccount-content",children:[e.jsxs("div",{className:"welcome",children:[r!=null&&r.image?e.jsx("img",{className:"img-fluid user-image",src:q(r==null?void 0:r.image),alt:"User Image"}):e.jsx("div",{className:"user-image",children:e.jsx(D,{})}),e.jsxs("p",{children:["Hello, ",e.jsx("strong",{children:r.name})," (If Not"," ",e.jsxs("strong",{children:[r.name," !"]}),e.jsxs("a",{onClick:t.logoutHandler,className:"logout",children:[" ","Logout"]}),")"]})]}),e.jsx("p",{className:"mb-0",children:"From your account dashboard. you can view your recent orders, manage your shipping and billing addresses and edit your password and account details."})]})})},te=async t=>{const s=(await f.get(`${C.ORDERS}?pageNumber=${t.pageNumber}`,{headers:{Authorization:t.token}})).data;if(s.status===200)return s.data;throw new Error((s==null?void 0:s.error)||"Unable to get orders")},de=t=>{var v;const r=g(a=>a.personalDetailsReducer.token),{data:s,isLoading:h,hasNextPage:u,fetchNextPage:n,isFetchingNextPage:o,isFetching:l}=M(b.ORDERS,({pageParam:a})=>te({pageNumber:a??1,token:r}),{getNextPageParam:a=>Math.ceil((a==null?void 0:a.totalItems)/20)>+(a==null?void 0:a.pageNumber)?+(a==null?void 0:a.pageNumber)+1:void 0}),m=j.useRef(null),c=s?(v=s==null?void 0:s.pages)==null?void 0:v.flatMap(a=>a.items):[],d=j.useCallback(a=>{a[0].isIntersecting&&u&&!o&&n()},[u,o]);return j.useEffect(()=>{const a=new IntersectionObserver(d,{rootMargin:"0px"}),{current:i}=m;return i&&a.observe(i),()=>{i&&a.unobserve(i)}},[d]),e.jsx("div",{className:`tab-pane fade ${t.isOrderActive?"active show":""}`,id:"orders",role:"tabpanel",children:e.jsx("div",{className:"myaccount-content",children:e.jsxs("div",{className:"myaccount-table table-responsive text-center",children:[e.jsxs("table",{className:"table table-bordered",children:[e.jsx("thead",{className:"thead-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Order"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Payment Status"}),e.jsx("th",{children:"Order Status"}),e.jsx("th",{children:"Total"}),e.jsx("th",{children:"Action"})]})}),e.jsxs("tbody",{children:[(c==null?void 0:c.length)>0&&(c==null?void 0:c.map((a,i)=>e.jsxs("tr",{children:[e.jsx("td",{children:i+1}),e.jsx("td",{children:T(a==null?void 0:a.updatedAt)}),e.jsx("td",{children:a==null?void 0:a.payment_status}),e.jsx("td",{children:a==null?void 0:a.order_status}),e.jsxs("td",{children:["â‚¹",a==null?void 0:a.total_amount]}),e.jsx("td",{children:e.jsx(U,{to:`${_.ORDER_DETAILS}/${a==null?void 0:a._id}`,className:"check-btn sqr-btn ",children:"View"})})]},a==null?void 0:a._id))),h||l||o?e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:"grey"})}),e.jsx("td",{children:e.jsx("span",{className:"grey"})}),e.jsx("td",{children:e.jsx("span",{className:"grey"})}),e.jsx("td",{children:e.jsx("span",{className:"grey"})}),e.jsx("td",{children:e.jsx("span",{className:"grey"})}),e.jsx("td",{children:e.jsx("span",{className:"grey"})})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:"grey"})}),e.jsx("td",{children:e.jsx("span",{className:"grey"})}),e.jsx("td",{children:e.jsx("span",{className:"grey"})}),e.jsx("td",{children:e.jsx("span",{className:"grey"})}),e.jsx("td",{children:e.jsx("span",{className:"grey"})}),e.jsx("td",{children:e.jsx("span",{className:"grey"})})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:"grey"})}),e.jsx("td",{children:e.jsx("span",{className:"grey"})}),e.jsx("td",{children:e.jsx("span",{className:"grey"})}),e.jsx("td",{children:e.jsx("span",{className:"grey"})}),e.jsx("td",{children:e.jsx("span",{className:"grey"})}),e.jsx("td",{children:e.jsx("span",{className:"grey"})})]})]}):null]})]}),e.jsx("div",{ref:m,style:{height:"10px"}})]})})})},le=()=>{var n;const t=g(o=>o.personalDetailsReducer),{state:r}=G(),s=L(),{isLoading:h}=K(b.PROFILE,W.bind(void 0,t.token),{enabled:!!t.token&&!((n=t.profileData)!=null&&n._id),onSuccess:o=>{s(w.fillProfileData({data:o.data}))}}),u=()=>{$("access-token"),s(w.flushData())};return j.useEffect(()=>{r!=null&&r.isOrderActive&&s(B.flushCart())},[r==null?void 0:r.isOrderActive]),e.jsx("div",{className:"my-account-area pt-100 pb-95",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row flex-row-reverse",children:e.jsx("div",{className:"col-lg-12",children:h?e.jsx("div",{className:"skeleton-1b7fljkf61d"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"myaccount-tab-menu nav",role:"tablist",children:[e.jsx("a",{href:"#dashboard",className:r!=null&&r.isOrderActive?"":"active","data-bs-toggle":"tab",children:"Dashboard"}),e.jsx("a",{href:"#orders",className:r!=null&&r.isOrderActive?"active":"","data-bs-toggle":"tab",children:"Orders"}),e.jsx("a",{href:"#account-info","data-bs-toggle":"tab",children:"Account Details"}),e.jsx("a",{href:"#change-pass","data-bs-toggle":"tab",children:"change password"}),e.jsx("a",{onClick:u,children:"Logout"})]}),e.jsxs("div",{className:"tab-content",id:"myaccountContent",children:[e.jsx(ie,{logoutHandler:u,isOrderActive:!!(r!=null&&r.isOrderActive)}),e.jsx(de,{isOrderActive:!!(r!=null&&r.isOrderActive)}),e.jsx(ae,{}),e.jsx(re,{})]})]})})})})})},oe=()=>e.jsxs(J,{children:[e.jsx(Q,{}),e.jsx(Z,{}),e.jsx(V,{title:"My Account"}),e.jsx(le,{}),e.jsx(X,{}),e.jsx(Y,{}),e.jsx(ee,{})]});export{oe as default};
